# PrivacyShutter---Auto-Privacy-Masking
# PrivacyShutter 利用ガイド

## 概要
**PrivacyShutter** は、Windows 11向けのスクリーンショット撮影・自動マスキングツールです。
画面上の個人情報（電話番号、住所、クレジットカード番号など）を自動的に検出し、黒塗りで隠します。

## 起動方法

1. **環境の準備**
   - 必要なライブラリがインストールされていることを確認してください。
     必要ライブラリ：custom tkinter , rapidocr-onnxruntime , opencv-python , pillow , mss , shapely
   - 仮想環境を使用している場合は、アクティブにしてください。

2. **アプリの実行**
   以下のコマンドでアプリケーションを起動します。

   ```powershell
   cd "展開先のフォルダ"
   python main.py
   ```

## 使い方

1. **スクリーンショット撮影**
   - 「Take Screenshot」ボタンをクリックします。
   - ウィンドウが一時的に隠れ、画面全体のスクリーンショットが撮影されます。
   - 撮影後、自動的にOCR処理とマスキングが行われ、プレビューが表示されます。

2. **画像の読み込み**
   - 「Load Image」ボタンをクリックし、既存の画像ファイル（.png, .jpg）を選択します。
   - 自動的に処理され、プレビューが表示されます。

3. **保存**
   - 処理結果に問題がなければ、「Save Image」ボタンで保存します。

## 機能詳細

- **自動検出対象**:
    - **電話番号**: 固定電話、携帯電話（ハイフン区切り）
    - **郵便番号**: 〒マークや `XXX-XXXX` 形式
    - **メールアドレス**
    - **クレジットカード番号**: 14〜16桁の数字
    - **住所・氏名**: 「住所」「氏名」などのキーワードに続くテキスト
    - **カスタムキーワード**: 左側のサイドバーに入力した任意の文字列

## その他の機能
- **カスタムキーワード登録**:
   - サイドバーの「Custom Keywords」入力欄に隠したい単語を入力し、「+」ボタンを押して登録します。
   - **強化されたマッチング**: 登録した単語は自動的に「文字間にスペースがあってもマッチする」ように変換されます。OCRが誤って文字を区切って認識した場合（例: `プ ロ ジ ェ ク ト`）でも、確実にマスキングが適用されます。
   - 登録した単語はリストに表示され、即座にマスキングが画面に反映されます。
   - 不要な単語は、リスト内の「X」ボタンで削除できます。リストは自動的に保存され、再起動後も保持されます。

- **Advanced Mode (高度な正規表現)**:
   - サイドバーの **「Advanced Rules Editor」** ボタンから、正規表現ルールをリスト形式で管理できます。
   - 隠したいパターンの正規表現を入力して「Add」で追加し、不要なものはリスト内の「X」ボタンで個別に削除できます。
   - **メリット**: 文字列を直接1行ずつ書き換える必要がなくなり、各パターンを安全に管理・削除できます。OCR特有の「文字の間のスペース」などを `\s*` を使って確実にキャッチするのに最適です。

- **OCRエンジン**:
    - `RapidOCR` (ONNX Runtime) を使用しており、ローカル環境で高速に動作します。外部へのデータ送信は一切ありません。

## 注意事項
- OCRの精度は画質やフォントに依存します。**保存前に必ずマスキング漏れがないか確認してください。**
- 現在のバージョンでは全画面キャプチャのみ対応しています。

